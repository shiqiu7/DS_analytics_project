---
title: "Google Merchandise Store Analysis"
output: pdf_document
header-includes: 
  - \usepackage{rotating, graphicx}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(readxl)
library(ggplot2)
library(knitr)

library(data.table)
```

## Part 1: Find the most valuable acquisition channel 

### Visualize user trends over time on Google Analytics

```{r, fig.pos= "H", out.width = "400px"}
include_graphics("image1.png")
```




### Import data from Google Analytics to R


```{r}
dat <- read_excel("Analytics 1 Master View Channels 20180810-20190810.xlsx", sheet = "Dataset1")
dat <- dat[!is.na(dat$Date), ]
dat$Date <- as.Date(dat$Date, format = "%Y%m%d")

```


### Explore data: For most acquisition channel, user in weekdays and weekend have significant difference, showing that weekend is a strong feature for number of users

```{r}
dat$dow <- lubridate::wday(dat$Date, label = TRUE)
dat$weekend <- 0
dat$weekend[dat$dow %in% c("Sat", "Sun")] <- 1

ggplot(dat, aes(x = Date,
                y = Users, color = factor(weekend))) +
  geom_point() +
  facet_wrap(~`Default Channel Grouping`)
```




```{r}
dat <- dat[dat$`Default Channel Grouping`!= "(Other)", ]
```

Controlling for:
1. time trends
2. the number of new users
3. whether or not it is a weekend

Use regression analysis to explore the relationship between acquisition channel and:
a. Bounce Rate
b. Average Session Duration
c. E-commerce Conversion Rate 
d. Revenue

##Conclusion: Referral is the only channel that has significant advantage in all the 4 metrics (low bounce rate, high session duration, conversion rate, and revenue), which means that it is the most valuable acquistion channel 
```{r, results = 'asis'}
R1 <- glm(`Bounce Rate` ~ `Default Channel Grouping` + Date + `New Users` + weekend, data = dat)
 summary(R1)

R2 <- lm(`Avg. Session Duration` ~ `Default Channel Grouping` + Date + `New Users` + weekend, data = dat)
 summary(R2)

R3 <- glm(`Ecommerce Conversion Rate` ~ `Default Channel Grouping` + Date + `New Users` + weekend, data = dat)
 summary(R3)

R4 <- lm(Revenue ~ `Default Channel Grouping` + Date + `New Users` + weekend, data = dat)
 summary(R4)

```




